"Interaction DB"


CREATE TABLE public.user_interactions (
	id uuid DEFAULT gen_random_uuid() NOT NULL,
	user_id int8 NOT NULL,
	content_id uuid NOT NULL,
	interaction_type varchar(255) NULL,
	created_at timestamp DEFAULT CURRENT_TIMESTAMP NULL,
	CONSTRAINT user_interactions_pkey PRIMARY KEY (id)
);

CREATE TABLE public.user_topic_preferences (
	id bigserial NOT NULL,
	user_id int8 NOT NULL,
	topic_id int4 NOT NULL,
	created_at timestamp DEFAULT CURRENT_TIMESTAMP NULL,
	CONSTRAINT ukd2fi03obns954edgon2c5ephl UNIQUE (user_id, topic_id),
	CONSTRAINT user_topic_preferences_pkey PRIMARY KEY (id),
	CONSTRAINT user_topic_preferences_user_id_topic_id_key UNIQUE (user_id, topic_id)
);

CREATE TABLE public.user_topic_scores (
	user_id int8 NOT NULL,
	topic_id int4 NOT NULL,
	score float8 DEFAULT 1.0 NULL,
	last_updated timestamp DEFAULT CURRENT_TIMESTAMP NULL,
	CONSTRAINT user_topic_scores_pkey PRIMARY KEY (user_id, topic_id)
);

pcc_auth_db


CREATE TABLE public.users (
	id int8 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 9223372036854775807 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"password" varchar(255) NOT NULL,
	"role" varchar(255) NULL,
	username varchar(255) NOT NULL,
	CONSTRAINT ukr43af9ap4edm43mmtq01oddj6 UNIQUE (username),
	CONSTRAINT users_pkey PRIMARY KEY (id)
);

postgres

CREATE TABLE public.contents (
	content_id uuid DEFAULT gen_random_uuid() NOT NULL,
	source_id int4 NULL,
	original_title varchar(500) NULL,
	original_text text NULL,
	original_url varchar(2000) NULL,
	published_date timestamp NULL,
	fetch_status varchar(255) DEFAULT 'PENDING'::character varying NULL,
	fetched_at timestamp DEFAULT CURRENT_TIMESTAMP NULL,
	url varchar(500) NULL,
	CONSTRAINT contents_pkey PRIMARY KEY (content_id)
);


-- public.contents foreign keys

ALTER TABLE public.contents ADD CONSTRAINT contents_source_id_fkey FOREIGN KEY (source_id) REFERENCES public.sources(source_id);


CREATE TABLE public.summaries (
	summary_id uuid DEFAULT gen_random_uuid() NOT NULL,
	content_id uuid NULL,
	title varchar(255) NULL,
	summary_text text NULL,
	generated_tags varchar(255) NULL,
	created_at timestamp DEFAULT CURRENT_TIMESTAMP NULL,
	topic_id int4 NULL,
	CONSTRAINT summaries_content_id_key UNIQUE (content_id),
	CONSTRAINT summaries_pkey PRIMARY KEY (summary_id)
);
CREATE INDEX idx_summaries_topic_id ON public.summaries USING btree (topic_id);


-- public.summaries foreign keys

ALTER TABLE public.summaries ADD CONSTRAINT fk_summaries_topic FOREIGN KEY (topic_id) REFERENCES public.topics(topic_id) ON DELETE SET NULL;
ALTER TABLE public.summaries ADD CONSTRAINT summaries_content_id_fkey FOREIGN KEY (content_id) REFERENCES public.contents(content_id);


CREATE TABLE public.topics (
	topic_id serial4 NOT NULL,
	"name" varchar(255) NOT NULL,
	CONSTRAINT topics_pkey PRIMARY KEY (topic_id)
);

INSERT INTO public.topics ("name") VALUES
	 ('Türkiye Gündemi'),
	 ('Dünya Gündemi'),
	 ('Ekonomi ve Finans'),
	 ('Futbol'),
	 ('Basketbol'),
	 ('Voleybol'),
	 ('Motor Sporları'),
	 ('Yapay Zeka (AI)'),
	 ('Yazılım ve Donanım'),
	 ('Bilim ve Uzay');
INSERT INTO public.topics ("name") VALUES
	 ('Oyun ve E-Spor'),
	 ('Girişimcilik ve Startup'),
	 ('Sinema ve Dizi'),
	 ('Müzik'),
	 ('Edebiyat ve Kitap'),
	 ('Sanat ve Tasarım'),
	 ('Sağlık ve İyi Yaşam'),
	 ('Seyahat ve Gezi'),
	 ('Otomotiv'),
	 ('Gastronomi');

CREATE TABLE public.user_profiles (
	user_id int8 NOT NULL,
	full_name varchar(255) NULL,
	birth_date date NULL,
	bio varchar(1000) NULL,
	"location" varchar(255) NULL,
	profile_picture_url text NULL,
	CONSTRAINT user_profiles_pkey PRIMARY KEY (user_id)
);


CREATE TABLE public.view_history (
	id uuid NOT NULL,
	content_id uuid NOT NULL,
	user_id int8 NOT NULL,
	viewed_at timestamp(6) NULL,
	CONSTRAINT view_history_pkey PRIMARY KEY (id)
);